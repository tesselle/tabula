<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matrix seriation — seriation • tabula</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Matrix seriation — seriation" />

<meta property="og:description" content="seriate computes a permutation order for rows and/or columns.
permute rearranges a data matrix according to a permutation order.
refine performs a partial bootstrap correspondance analysis
 seriation refinement." />

<meta property="og:image" content="http://tabula.archaeo.science/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tabula.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diversity.html">Diversity measures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matrix seriation</h1>
    <small class="dont-index">Source: <a href='https://github.com/nfrerebeau/tabula/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/nfrerebeau/tabula/blob/master/R/refine.R'><code>R/refine.R</code></a>, <a href='https://github.com/nfrerebeau/tabula/blob/master/R/seriate.R'><code>R/seriate.R</code></a></small>
    <div class="hidden name"><code>seriation.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>seriate</code> computes a permutation order for rows and/or columns.</p>
<p><code>permute</code> rearranges a data matrix according to a permutation order.</p>
<p><code>refine</code> performs a partial bootstrap correspondance analysis
 seriation refinement.</p>
    
    </div>

    <pre class="usage"><span class='fu'>seriate</span>(<span class='no'>object</span>, <span class='no'>subset</span>, <span class='no'>...</span>)

<span class='fu'>permute</span>(<span class='no'>object</span>, <span class='no'>order</span>, <span class='no'>...</span>)

<span class='fu'>refine</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for CountMatrix</span>
<span class='fu'>refine</span>(<span class='no'>object</span>, <span class='no'>cutoff</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,
  <span class='fl'>2</span>), <span class='no'>...</span>)

<span class='co'># S4 method for CountMatrix,missing</span>
<span class='fu'>seriate</span>(<span class='no'>object</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"correspondance"</span>, <span class='st'>"reciprocal"</span>), <span class='kw'>EPPM</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>stop</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='no'>...</span>)

<span class='co'># S4 method for IncidenceMatrix,missing</span>
<span class='fu'>seriate</span>(<span class='no'>object</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"correspondance"</span>, <span class='st'>"reciprocal"</span>), <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>),
  <span class='kw'>stop</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='no'>...</span>)

<span class='co'># S4 method for CountMatrix,BootCA</span>
<span class='fu'>seriate</span>(<span class='no'>object</span>, <span class='no'>subset</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>),
  <span class='no'>...</span>)

<span class='co'># S4 method for CountMatrix,PermutationOrder</span>
<span class='fu'>permute</span>(<span class='no'>object</span>, <span class='no'>order</span>)

<span class='co'># S4 method for IncidenceMatrix,PermutationOrder</span>
<span class='fu'>permute</span>(<span class='no'>object</span>, <span class='no'>order</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An \(m \times p\) data matrix.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>A <a href='BootCA-class.html'>BootCA</a> object giving the subset of
<code>object</code> to be used.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to other methods.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>A <a href='PermutationOrder-class.html'>PermutationOrder</a> object giving the permutation
order for rows and columns.</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>A function that takes a numeric vector as argument and returns
a single numeric value (see details).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>A non-negative <code><a href='https://www.rdocumentation.org/packages/base/topics/integer'>integer</a></code> giving the number of partial
bootstrap replications (see details).</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>A <code><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></code> vector giving the subscripts of the CA
axes to use (see details).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A <code><a href='https://www.rdocumentation.org/packages/base/topics/character'>character</a></code> string specifiying the method to be
used. This must be one of "<code>reciprocal</code>", "<code>correspondance</code>"
(see details). Any unambiguous substring can be given.</p></td>
    </tr>
    <tr>
      <th>EPPM</th>
      <td><p>A <code><a href='https://www.rdocumentation.org/packages/base/topics/logical'>logical</a></code> scalar: should the seriation be computed
on EPPM instead of raw data?</p></td>
    </tr>
    <tr>
      <th>margin</th>
      <td><p>A <code><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></code> vector giving the subscripts which the
rearrangement will be applied over: <code>1</code> indicates rows, <code>2</code>
indicates columns, <code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c(1, 2)</a></code> indicates rows then columns,
<code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c(2, 1)</a></code> indicates columns then rows.</p></td>
    </tr>
    <tr>
      <th>stop</th>
      <td><p>A length-one <code><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></code> vector giving the stopping rule
(i.e. maximum number of iterations) to avoid infinite loop.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>seriate</code> returns a <a href='PermutationOrder-class.html'>PermutationOrder</a> object.</p>
<p><code>permute</code> returns either a
 <a href='CountMatrix-class.html'>CountMatrix</a>, <a href='FrequencyMatrix-class.html'>FrequencyMatrix</a> or
 <a href='IncidenceMatrix-class.html'>IncidenceMatrix</a> (the same as <code>object</code>).</p>
<p><code>refine</code> returns a <a href='BootCA-class.html'>BootCA</a> object containing the subscript
 of samples to be kept (i.e. samples with maximum dimension length of the
 convex hull smaller than the cutoff value).</p>
    
    <h2 class="hasAnchor" id="seriation"><a class="anchor" href="#seriation"></a>Seriation</h2>

    
    <p>The matrix seriation problem in archaeology is based on three conditions
 and two assumptions, which Dunell (1970) summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a
 seriation must:</p><ol>
<li><p>Be of comparable duration.</p></li>
<li><p>Belong to the same cultural tradition.</p></li>
<li><p>Come from the same local area.</p></li>
</ol>
    <p>The mathematical assumptions state that the distribution of any historical
 or temporal class:</p><ol>
<li><p>Is continuous through time.</p></li>
<li><p>Exhibits the form of a unimodal curve.</p></li>
</ol><p>Theses assumptions create a distributional model and ordering is
 accomplished by arranging the matrix so that the class distributions
 approximate the required pattern. The resulting order is infered
 to be chronological.</p>
<p>The following seriation methods are available:</p><dl class='dl-horizontal'>
  <dt>correspondance</dt><dd><p>Correspondance analysis-based seriation.
  Correspondance analysis (CA) is an effective method for the seriation of
  archaeological assemblages. The order of the rows and columns is given by
  the coordinates along one dimension of the CA space, assumed to account
  for temporal variation. The direction of temporal change within the
  correspondance analysis space is arbitrary: additional information is
  needed to determine the actual order in time.</p></dd>
  <dt>reciprocal</dt><dd><p>Reciprocal ranking (incidence data) or averaging
  (frequency data) seriation. These procedures iteratively rearrange rows
  and/or columns according to their weighted rank in the data matrix until
  convergence. Note that this procedure could enter into an infinite loop.
  If no convergence is reached before the maximum number of iterations, it
  stops with a warning.</p></dd>
 </dl>
    
    <h2 class="hasAnchor" id="ca-seriation-refining"><a class="anchor" href="#ca-seriation-refining"></a>CA seriation refining</h2>

    
    <p><code>refine</code> allows to identify samples that are subject to sampling error
 or samples that have underlying structural relationships and might be
 influencing the ordering along the CA space.</p>
<p>This relies on a partial bootstrap approach to CA-based seriation where each
 sample is replicated <code>n</code> times. The maximum dimension length of
 the convex hull around the sample point cloud allows to remove samples for
 a given <code>cutoff</code> value.</p>
<p>According to Peebles and Schachner (2012), "[this] point removal procedure
 [results in] a reduced dataset where the position of individuals within the
 CA are highly stable and which produces an ordering consistend with the
 assumptions of frequency seriation."</p>
<p>If the results of <code>refine</code> is used as an input argument in
 <code>seriate</code>, a correspondance analysis is performed on the subset of
 <code>object</code> which matches the samples to be kept. Then excluded samples
 are projected onto the dimensions of the CA coordinate space using the row
 transition formulae. Finally, row coordinates onto the first dimension
 give the seriation order.</p>
<p>To monitor the execution of these re-sampling procedure, a progress bar
 will automatically be displayed if the <code><a href='https://www.rdocumentation.org/packages/pbapply/topics/pbapply'>pbapply</a></code>
 package is installed on your machine.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Desachy, B. (2004). Le sériographe EPPM: un outil informatisé de sériation
 graphique pour tableaux de comptages. <em>Revue archéologique de
 Picardie</em>, 3(1), 39-56.
 DOI: <a href='https://doi.org/10.3406/pica.2004.2396'>10.3406/pica.2004.2396</a>.</p>
<p>Dunnell, R. C. (1970). Seriation Method and Its Evaluation. <em>American
 Antiquity</em>, 35(03), 305-319.
 DOI: <a href='https://doi.org/10.2307/278341'>10.2307/278341</a>.</p>
<p>Ihm, P. (2005). A Contribution to the History of Seriation in Archaeology.
 In C. Weihs &amp; W. Gaul (Eds.), <em>Classification: The Ubiquitous Challenge</em>
 (p. 307-316). Berlin Heidelberg: Springer.
 DOI: <a href='https://doi.org/10.1007/3-540-28084-7_34'>10.1007/3-540-28084-7_34</a>.</p>
<p>Peeples, M. A., &amp; Schachner, G. (2012). Refining correspondence
 analysis-based ceramic seriation of regional data sets. <em>Journal of
 Archaeological Science</em>, 39(8), 2818-2827.
 DOI: <a href='https://doi.org/10.1016/j.jas.2012.04.040'>10.1016/j.jas.2012.04.040</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>refine <a href='https://www.rdocumentation.org/packages/FactoMineR/topics/CA'>CA</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Matrix seriation</span>
<span class='co'># Reproduces Desachy 2004 results</span>
<span class='co'>## Coerce dataset to abundance matrix</span>
<span class='no'>compiegne_count</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>compiegne</span>, <span class='st'>"CountMatrix"</span>)

<span class='co'>## Get seriation order for columns on EPPM using the reciprocal averaging method</span>
<span class='co'>## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</span>
(<span class='no'>compiegne_indices</span> <span class='kw'>&lt;-</span> <span class='fu'>seriate</span>(<span class='no'>compiegne_count</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"reciprocal"</span>,
                              <span class='kw'>EPPM</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fl'>2</span>))</div><div class='output co'>#&gt; Permutation order for matrix seriation: 
#&gt;    Row order: 1 2 3 4 5 
#&gt;    Column order: 14 1 3 11 16 12 2 5 9 13 4 7 15 10 6 8 
#&gt;    Method: reciprocal</div><div class='input'>
<span class='co'>## Permute columns</span>
<span class='no'>compiegne_new</span> <span class='kw'>&lt;-</span> <span class='fu'>permute</span>(<span class='no'>compiegne_count</span>, <span class='no'>compiegne_indices</span>)

<span class='co'>## Plot new matrix</span>
<span class='fu'><a href='plotBar-method.html'>plotBar</a></span>(<span class='no'>compiegne_new</span>, <span class='kw'>EPPM</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='seriation-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div><div class='input'><span class='co'># Refine matrix seriation (this is a long running example)</span>
<span class='co'># Reproduces Peeples and Schachner 2012 results</span>
<span class='no'>zuni_count</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>zuni</span>, <span class='st'>"CountMatrix"</span>)

<span class='co'>## Samples with convex hull maximum dimension length greater than the cutoff</span>
<span class='co'>## value will be marked for removal.</span>
<span class='co'>## Define cutoff as one standard deviation above the mean</span>
<span class='no'>fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) { <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>x</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/sd'>sd</a></span>(<span class='no'>x</span>) }

<span class='co'>## Get indices of samples to be kept</span>
<span class='co'>## Warning: this may take a few seconds!</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
(<span class='no'>zuni_refined</span> <span class='kw'>&lt;-</span> <span class='fu'>refine</span>(<span class='no'>zuni_count</span>, <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='no'>fun</span>))</div><div class='output co'>#&gt; Partial bootstrap CA seriation refinement:
#&gt;   Cutoff: 2.22
#&gt;   Rows to keep: 349 of 420 (83%)</div><div class='input'>
<span class='co'>## Get CA-based seriation order</span>
(<span class='no'>zuni_indices</span> <span class='kw'>&lt;-</span> <span class='fu'>seriate</span>(<span class='no'>zuni_count</span>, <span class='no'>zuni_refined</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fl'>1</span>))</div><div class='output co'>#&gt; Permutation order for matrix seriation: 
#&gt;    Row order: 372 350 387 367 110 417 364 357 407 406 160 344 348 356 373 384 378 362 339 383... (400 more) 
#&gt;    Column order: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 
#&gt;    Method: refined correspondance</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#seriation">Seriation</a></li>

      <li><a href="#ca-seriation-refining">CA seriation refining</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>N. Frerebeau</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

